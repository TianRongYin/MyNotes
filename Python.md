# Python

## 入门

**经典**：print("hello,world")

**字面量**：

- 固定写死的数据
- 特殊字面量：None,等同于null

**注释：**

- 单行注释：#开头，#右边的文字当作文字说明，==建议#后面加空格与说明文字隔开==
- 多行注释：一对三个双引号包裹，”“”注释内容“”“,在方法内部三引号敲回车自动形成注释

**常用语句**：

- `print()`打印数据到控制台，数据用==逗号==隔开（输出对应空格隔开）
  - `print(内容,end='')`:不换行（默认换行）

- `type()`查看数据类型，变量没有类型但是变量存储的数据有类型
- `str()`类型转换，浮点数转整数丢失精度
- `input(提示语句)`数据输入，括号内输出提示信息，==接收到的数据全部以字符串的形式存储==
- `range()`取数字序列
  - `range(5)`=>[0,1,2,3,4]
  - `range(5,10)`=>[5,6,7,8,9]
  - `range(5,10,2)`=>[5,7,9]


**运算符：**

- '//'：取整除，返回商的整数部分
- '**'：指数，`2**5`指2的5次方
- `c**=a`相当于`c=c**a`

**字符串的定义方式：**

- 单引号，双引号和三引号（不用变量接收的字符串就变成注释）都能定义字符串内容
- 引号嵌套的情况
  - 可以通过单引号中包含双引号或双引号中包含单引号来解决
  - 转义字符`\`：转义字符后的符号不具备效用

**字符串拼接：**

- "+"，可以通过加号链接
- 占位符，通过%占位，将数据填入。
  - 示例：`message = "我的名字叫%s，年龄%s" %(name,age)`
  - `%s`：转换为字符串放入占位位置，`%d`：转换为整数，`%f`：转换为浮点数
    - 精度控制：`%m.nf`或者`%md`
    - m控制数字宽度（数字宽度大于m将不生效，小于则补空格），n控制小数点精度（可以进行四舍五入）
  - `f内容{变量}` ：快速写法`print(f"我是{变量}")`
    - 这种方式不做精度控制也不管类型

- 表达式可以作为变量使用占位符

**if判断：**

`if 判断语句 : 执行语句 elif 判断语句 : 执行语句else: 执行语句`

**循环：**

- `while 条件:执行`
- `for 临时变量 in 某序列`
- `continue`停止当前这次循环，执行本循环的下一次，`break`停止当前循环

**函数**：

- `def 函数名(传入参数): (return 返回值)`,在函数内部使用global关键字声明全局变量
- 多返回值：`return x, y ,z`接收： `x, y. z = test_return()`
- 参数传递：
  - 位置传递：即正常传递，哪个位置就是哪个参数
  - 关键字传递：通过键值对传递参数即`user_info(name="ming",age=20)`，
  - 位置传递和关键字传递混用的时候，位置参数必须在关键字参数的前面
  - 缺省函数：即默认值`def user_info(name,age,gender="男")：`
  - 不定长位置传递：语法：`def user_info(*args)：`接收无论多少个元素并用元组（args）存储
  - 不定长关键字传递：语法：`def user_info(**kwargs)：`不论多少个键值对用字典（kwargs）存储
  - 函数作为参数传递：传递的是计算逻辑而不是数据
- 匿名函数（lambda表达式）
  - 语法：`lambda 传入参数: 函数体`
  - 函数体只能是一行代码，不能多行
  - 通常作为参数传递，例如`def test_func(lambda x, y: x + y)`


## 数据容器

### 序列

- list列表:可以封装多种数据类型,并且有序可重复
  - 定义:`my_list = list()或者my_list = []`,可以嵌套
  - 索引:从0开始,可以反向索引(倒序取出)
  - 方法:
    - len(列表):统计列表长度
    - index(元素):查找某元素的下标索引,如果查找元素不存在会报错
    - insert(下标,元素):在指定下标插入指定元素
    - append(元素):插入元素到列表尾部
    - extend(其他数据容器):在列表尾部插入一批其他数据容器里的元素
    - del 列表[下标]:删除元素
    - pop(下标):弹出并删除元素
    - remove(元素):删除第一个匹配项
    - clear():清空列表
    - count(元素):统计元素出现次数
- 元组:==一旦定义就不可被修改==
  - 定义:用小括号,内部数据用逗号隔开`变量名称 = tuple()或者 变量名称 = ()`
- 字符串:==不可修改==
  - 方法:
    - index()、len(字符串)、count()
    - replace(字符串1,字符串2):将原字符串内所有字符串1替换成字符串2,得到一个新的字符串
    - split(分隔符字符串):根据分隔符字符串将原字符串分割成很多个字符串并且用一个列表存起来
    - strip(字符串):==不加参数去掉前后空格==,加参数则去掉前后指定字符串(按照单个字符去除)
- 切片：
  - 语法：`序列[起始下标:结束下标:步长]`
  - 从序列中从起始下标跨越步长到结束下标依次取出元素并形成一个新的序列
  - 起始下标、结束下标和步长都可以省略，默认从头到尾依次取出
  - 当步长为负数的时候，将从末尾开始取出元素（倒序取出）


### 集合与字典

- 集合：无序且不重复
  - 定义：`my_set = set()` `my_set = {元素1,元素2}`，==定义空的集合不用使用大括号。因为大括号被字典占用了==
  - 方法：
    - add()添加元素、remove()移除元素、clear()清空元素、len()统计长度
    - pop()：随机取出一个元素
    - 集合1.difference(集合2)：得到集合1和集合2的差集（集合1有而集合2没有），得到一个新集合
    - 集合1.difference_update(集合2)：在集合1中删除集合2相同的元素，集合1被修改
    - 集合1.union(集合2)：将集合1和集合2合并成一个新的集合（原集合不变）
  - 遍历：不能用while，可以用for循环遍历
- 字典：键值对，==支持嵌套（值可以是字典）==
  - 定义：`my_dict = dict() 或者my_dict = {}`
  - 方法：
    - 字典[Key] = Value：新增或更新元素
    - pop(Key)：取出并从字典删除元素
    - clear()：清空元素、len()统计长度
    - 字典.keys()：得到字典中的全部Key
    - 字典.values()：得到全部value
    - zip(keys，values)：两个序列通过zip函数返回一个列表，长度不等取短
  - 遍历：`for key,value in 字典.items()`，items返回所有键值对

### 通用操作

- len()统计长度、clear()清空、max()取最大、min()取最小
- list(其他数据容器)、tuple(其他数据容器)、str(其他数据容器)、set(其他数据容器)
  - 数据容器转换，字典转换成序列时会丢失Value值，只有Key
  - 其他数据容器转换成Set集合会打乱顺序
- sorted(数据容器,[reverse=True])
  - 排序算法，reverse=Ture表示降序，不写即正序
  - 排序后的数据将用列表存储，所以字典排序后会丢失Value

## 文件

- 打开文件：
  - 语法：`open(name,mode,encoding)`，返回一个文件对象
    - name是目标文件名（也可以是具体路径）
    - mode是打开文件的模式
      - “r”：只读模式，文件的指针放在开头
      - “w”：只写模式，创建新文件并开始编辑，如果已存在同名文件则原有内容被删除
      - “a”：追加模式，在该文件中进行追加内容，没有则创建新文件进行编辑
    - encoding：编码格式，默认是utf-8
- 读操作：
  - read(num)：num表示从文件中读取数据的长度，单位是字节，如果没有传入num则读取全部
  - readlines()：按照整行的方式将文件中的所有数据一次性读取，并用列表存储每行数据，每一行一个元素，返回列表
  - readline()：读取一行
  - 每一次读的操作指针都会跟随移动，不会从头读
  - 循环读取：`for line in 文件对象: `
- 写操作：
  - write(写入内容)：将内容写进内存中，并没有直接写进硬盘
  - flush()：刷新，将内存中积攒的内容写入硬盘
- 文件关闭：`文件对象.close`
- `with open(name,mode,encoding) as 文件对象 :`：在当前方法下对文件执行一系列操作并自动关闭文件，不用手动关闭
- `os.path.exists()`是否存在此文件

## 异常

```
try:
except Exception as 别名:
else: #没有异常将会执行的代码
final: #无论有没有异常都会执行的代码
```

- 异常捕获的多种类型可以用元组传递参数`except (...) :`
- `as`是起别名的用法
- except不加任何修饰则捕捉所有异常

## 模块

-  导入模块

  - 语法：`[from 模块名] import [ 模块 | 类 | 变量 | 函数 | * ] [as 别名]` 
  - from可以省略，省略后直接导入整个模块，需要模块名加' . '调用内部函数或变量
  - `from 模块名 import 方法`直接导入方法，可以直接调用
  - `from 模块名 import *`导入模块内所有内容
  - 导入两个模块的同名方法时，后面那个会覆盖前面模块的方法

- 自定义模块

  - `__name__`：内置变量，值为`'__main__'`

    - 模块内部通常会对方法进行测试，而导入模块的同时会运行该模块，为了让测试代码不在导入时被运行

      在自定义模块内部用`if __name__ == '__main__' : 测试代码'`

  - `__all__ = ['testA']`：当使用`from xxx import *`时，只导入`__all__`列表中的所有元素

- 自定义包

  - 新建一个python包，自带`__init__.py`的python文件，删除后就是普通文件夹
  - 在这个python包内可以创建多个模块，通过`包名.模块名`导入
  - `__init__.py`：该文件可以使用`__all__ `控制导入模块

- 第三方包

  - `pip install 包名`安装第三方包
  - 网络优化：`pip install -i https: //pypi.tuna.tsinghua.edu.cn/simple`
  - pycharm上安装：Interpret Settings中添加第三方包，在options中`-i https: //pypi.tuna.tsinghua.edu.cn/simple`优化网络

## 数据处理

- Json格式转化
  - 导入json模块
    - `json.dumps(data[,ensure_ascii=False])`把python数据转化成json数据，返回的是字符串，ensure_ascii=False表示不使用ASCII编码，因为ASCII编码不显示中文
    - `json.loads(data)`把json数据转换成python数据，返回一个列表或字典，返回列表将嵌套字典
- pyecharts模块
  - 简介：Echarts框架的python版本，用于形成图表
  - 安装：`pip install pyecharts`
  - [官方画廊](https:/lgallery.pyecharts.org/#/README)


## 类和对象

- 定义

  ```python
  class Student:
      name = None
      age = None
      address = None
  
      def __init__(self, name, age, address):
          self.name = name
          self.age = age
          self.address = address
  ```

- 成员方法的参数中必须加入`self`关键字，并且在方法内部通过`self`调用成员变量

- 魔术方法：（内置的类方法）
  - `__init__`：构造方法
  - `__str__`：相当于java中的`toString`方法，打印对象的内容而不是地址值，返回字符串
  - `__lt__`：用于对象的小于和大于的比较，传入参数other代表另一个对象，返回true或false
  - `__le__`：用于小于等于或大于等于的比较
  - `__eq__`：用于等于的比较

- 封装：成员变量或成员方法之前加入两条下划线`__`就能让该变量（方法）变成私有属性
- 继承：
  - `class stu(父类1,父类2,父类3....)`，多继承靠前的父类覆盖后面父类的同名成员变量和方法
  - 重写父类的方法或变量后，可以通过`super().`调用父类的成员变量和方法也可以直接通过`父类名.`调用
- 类型注解：（只是提示性的，并不影响程序的运行）
  - 变量
    - 给变量赋上一个数据类型，帮助PyCharm等开发工具做代码提示，也是开发者自身做类型的备注
    - 语法：`变量名 : 数据类型`或 注释:`# type: 数据类型`，比如`my_list : list[int] = [1, 2 ,3 ]`
  - 方法
    - 可以给形参和返回值进行类型注解
    - 语法：`def 函数方法名(形参 : 数据类型,...形参 : 数据类型) -> 返回值类型: `
  - Union联合类型注解
    - 导包：`from typing import Union`
    - 用法：`my_list : list[Union[str,int]] = ["字符串",123] `
    - 使用Union联合类型注解就能表示多种数据类型了
- 多态：
  - 包含抽象方法的类就是抽象类（接口），抽象方法就是没有具体实现的方法（==pass==）

## 数据库

- 连接并查询数据库

```
import pymysql

# 连接数据库
db = pymysql.connect(host='localhost',user='root',password='123456',port=3306)

# 创建数据库的游标
cursor = db.cursor()

#execute()方法并执行 SQL 语句
cursor.execute("select version()")

# 读取第一条数据
data = cursor.fetchone()
#fetchall()查询当前游标至结束的所有行数据。使用fetchmany(size)查询多条数据
print(data)

# 关闭连接
db.close()
```

- 修改数据

```
try:
    sql = 'update students set name=%s where id=%s'
    cursor.execute(sql,('李四','10004'))
    db.commit()
except:
    db.rollback()
```

## 一些方法

- 枚举`enumerate()`是python的内置函数，enumerate将其组成一个索引序列，利用它可以同时获得索引和值
  - `for index, item in enumerate(list, 1):`第二个参数用于指定索引初始值，可省略

# 杂记

- 制表符`\t`：穿插在字符串之间输出的时候能将多行字符串进行对齐，效果相当于在键盘上按tab键
- 换行符`\n`
- id求地址值
- 控制字符串输出格式：`print("我的{}很大".format(j))`，花括号内可以用数字指定参数位置，也可以用变量名指定

- `.isdigit()`判断字符串是否仅含有数字

